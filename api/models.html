
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>snat_sim.models &#8212; Supernova Atmospheric Simulation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_style.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="snat_sim.plasticc" href="plasticc.html" />
    <link rel="prev" title="snat_sim.constants" href="constants.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plasticc.html" title="snat_sim.plasticc"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="constants.html" title="snat_sim.constants"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SNAT-SIM</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">snat_sim.models</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../index.html" class="text-logo">SNAT-SIM</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/install.html">Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/data_provenance.html">Data Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/integrations.html">Package Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/command_line.html">Command Line Interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Notebooks / Science Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/notebook_summaries.html">Notebook Summaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/lsst_filters.html">LSST Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/pwv_eff_on_black_body.html">Effective PWV on a Black Body</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sne_delta_mag.html">PWV effects on SN Magnitude</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/pwv_modeling.html">PWV Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/simulating_lc_for_cadence.html">Simulating Light-Curves with a Cadence</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data_paths.html">snat_sim.data_paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">snat_sim.constants</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">snat_sim.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="plasticc.html">snat_sim.plasticc</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference_stars.html">snat_sim.reference_stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline/pipeline.html">snat_sim.pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="sn_magnitudes.html">snat_sim.sn_magnitudes</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">snat_sim.plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils/utils.html">snat_sim.utils</a></li>
</ul>

    
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">

          <div class="document clearer body">
            
  <div class="section" id="module-snat_sim.models">
<span id="snat-sim-models"></span><h1>snat_sim.models<a class="headerlink" href="#module-snat_sim.models" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">modeling</span></code> module defines classes for modeling different
physical phenomena. This includes SNe Ia light-curves, the propagation of
light through atmospheric water vapor (with and without variation in time),
and the seasonal variation of precipitable water vapor over time.</p>
<div class="section" id="model-summaries">
<h2>Model Summaries<a class="headerlink" href="#model-summaries" title="Permalink to this headline">¶</a></h2>
<p>A summary of the available models is provided below:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">PWVTransmissionModel</span></code></p></td>
<td><p>Models atmospheric transmission due to PWV at a fixed resolution</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">PWVModel</span></code></p></td>
<td><p>Model for interpolating the atmospheric water vapor at a given time and time</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SNModel</span></code></p></td>
<td><p>An observer-frame supernova model composed of a Source and zero or more effects</p></td>
</tr>
</tbody>
</table>
<p>Supernova models (<code class="docutils literal notranslate"><span class="pre">SNModel</span></code>) are designed to closely resemble the behavior
of the <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code> package. However, unlike <code class="docutils literal notranslate"><span class="pre">sncosmo.Model</span></code> objects, the
<code class="docutils literal notranslate"><span class="pre">snat_sim.SNModel</span></code> class provides support for propogation effects that vary
with time. A summary of propagation effects provided by the <code class="docutils literal notranslate"><span class="pre">snat_sim</span></code>
package is listed below:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">StaticPWVTrans</span></code></p></td>
<td><p>Propagation effect for the atmospheric absorption of light due to time static PWV</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SeasonalPWVTrans</span></code></p></td>
<td><p>Atmospheric propagation effect for a fixed PWV concentration per-season</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">VariablePWVTrans</span></code></p></td>
<td><p>Propagation effect for the atmospheric absorption of light due to time variable PWV</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="usage-example">
<h2>Usage Example<a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h2>
<p>To ensure ease of use, supernovae modeling with the <code class="docutils literal notranslate"><span class="pre">snat_sim</span></code> package is
backwards compatibile with the <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code> package and follows a similar
<a class="reference external" href="https://sncosmo.readthedocs.io/en/stable/models.html">design pattern</a>.
The <code class="docutils literal notranslate"><span class="pre">SNModel</span></code> class from <code class="docutils literal notranslate"><span class="pre">snat_sim</span></code> acts as a drop in replacements for
the <code class="docutils literal notranslate"><span class="pre">Model</span></code> classes built in to <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code> but provides extended
functionality.</p>
<p>Like <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code>, models are instantiated for a given spectral
template and various propagation effects can be added to the model. In the
following example, atmospheric propagation effects due to precipitable water
vapor are added to a Salt2 supernova model.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">snat_sim</span> <span class="kn">import</span> <span class="n">models</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a supernova model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">supernova_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SNModel</span><span class="p">(</span><span class="s1">&#39;salt2&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a model for the atmosphere</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atm_transmission</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">StaticPWVTrans</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atm_transmission</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">pwv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">supernova_model</span><span class="o">.</span><span class="n">add_effect</span><span class="p">(</span><span class="n">effect</span><span class="o">=</span><span class="n">atm_transmission</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Atmosphere&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Unlike <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code>, the process of simulating or fitting light-curves is
handled directly from the model class. Lets consider these two cases seperately.</p>
<div class="section" id="simulating-light-curves">
<h3>Simulating Light-Curves<a class="headerlink" href="#simulating-light-curves" title="Permalink to this headline">¶</a></h3>
<p>To simulate a light-curve, you first need to establish the desired light-curve
cadence (i.e., how the light-curve should be sampled in time):</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cadence</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ObservedCadence</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">obs_times</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">bands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sdssr&#39;</span><span class="p">,</span> <span class="s1">&#39;sdssr&#39;</span><span class="p">,</span> <span class="s1">&#39;sdssr&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">zp</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">zpsys</span><span class="o">=</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="n">skynoise</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Light-curves can then be simulated directly from the model using the
<code class="docutils literal notranslate"><span class="pre">simulate_lc</span></code> method:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Here we simulate a light-curve with statistical noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">light_curve</span> <span class="o">=</span> <span class="n">supernova_model</span><span class="o">.</span><span class="n">simulate_lc</span><span class="p">(</span><span class="n">cadence</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Here we simulate a light-curve with a fixed signal to noise ratio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">light_curve_fixed_snr</span> <span class="o">=</span> <span class="n">supernova_model</span><span class="o">.</span><span class="n">simulate_lc</span><span class="p">(</span><span class="n">cadence</span><span class="p">,</span> <span class="n">fixed_snr</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fitting-light-curves">
<h3>Fitting Light-Curves<a class="headerlink" href="#fitting-light-curves" title="Permalink to this headline">¶</a></h3>
<p>Photometric data can be fit directly from the model using the <code class="docutils literal notranslate"><span class="pre">fit_lc</span></code> method.
Notice in the below example that the returned object types are classes from the
<code class="docutils literal notranslate"><span class="pre">snat_sim</span></code> package:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sncosmo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">snat_sim.models</span> <span class="kn">import</span> <span class="n">SNModel</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">sncosmo</span><span class="o">.</span><span class="n">load_example_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_to_fit</span> <span class="o">=</span> <span class="n">SNModel</span><span class="p">(</span><span class="s1">&#39;salt2&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We set fix the z and t0 and then vary the remaining parameters during the fit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_to_fit</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">t0</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit_result</span><span class="p">,</span> <span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model_to_fit</span><span class="o">.</span><span class="n">fit_lc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">vparam_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">,</span> <span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">fit_result</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">))</span>
<span class="go">&lt;class &#39;snat_sim.models.supernova.SNFitResult&#39;&gt; &lt;class &#39;snat_sim.models.supernova.SNModel&#39;&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SNFitResult</span></code> object is similar to the <code class="docutils literal notranslate"><span class="pre">Result</span></code> class from <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code>
but <strong>is not backwards compatible</strong>. <code class="docutils literal notranslate"><span class="pre">SNFitResult</span></code> instances provide access
to fit results as floats or <code class="docutils literal notranslate"><span class="pre">pandas</span></code> objects (e.g., <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> or
<code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>) depending on the value.</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fit_result</span><span class="p">)</span>
<span class="go">     success: True</span>
<span class="go">     message: Minimization exited successfully.</span>
<span class="go">       ncall: 77</span>
<span class="go">        nfit: 1</span>
<span class="go">       chisq: 35.863</span>
<span class="go">        ndof: 37</span>
<span class="go"> param_names: [&#39;z&#39;, &#39;t0&#39;, &#39;x0&#39;, &#39;x1&#39;, &#39;c&#39;]</span>
<span class="go">  parameters: [5.000e-01 5.510e+04 1.188e-05 4.382e-01 2.190e-01]</span>
<span class="go">vparam_names: [&#39;x0&#39;, &#39;x1&#39;, &#39;c&#39;]</span>
<span class="go">      errors: [3.777e-07 3.178e-01 2.862e-02]</span>
<span class="go">  covariance:</span>
<span class="go">    [[ 1.426e-13 -6.461e-08 -7.622e-09]</span>
<span class="go">     [-6.461e-08  1.010e-01  1.223e-03]</span>
<span class="go">     [-7.622e-09  1.223e-03  8.189e-04]]</span>
</pre></div>
</div>
<p>Fit result objects are also capable of calculating the variance in the
distance modulus given the alpha/beta standerdization parameters:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">snat_sim</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">betoule_alpha</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">betoule_beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu_variance</span> <span class="o">=</span> <span class="n">fit_result</span><span class="o">.</span><span class="n">mu_variance_linear</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mu_variance</span><span class="si">:</span><span class="s1"> .5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go"> 0.00735</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-docs">
<h2>Module Docs<a class="headerlink" href="#module-docs" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-snat_sim.models.supernova">
<span id="modeling-supernova-observations"></span><h2>Modeling Supernova Observations<a class="headerlink" href="#module-snat_sim.models.supernova" title="Permalink to this headline">¶</a></h2>
<p>Modeling functionality for the spectro-photometric time-sampling of
supernovae.</p>
<dl class="py class">
<dt id="snat_sim.models.supernova.ObservedCadence">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.supernova.</span></code><code class="sig-name descname"><span class="pre">ObservedCadence</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">obs_times</span></em>, <em class="sig-param"><span class="pre">bands</span></em>, <em class="sig-param"><span class="pre">skynoise=&lt;property</span> <span class="pre">object&gt;</span></em>, <em class="sig-param"><span class="pre">zp=&lt;property</span> <span class="pre">object&gt;</span></em>, <em class="sig-param"><span class="pre">zpsys=&lt;property</span> <span class="pre">object&gt;</span></em>, <em class="sig-param"><span class="pre">gain=&lt;property</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#ObservedCadence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.ObservedCadence" title="Permalink to this definition">¶</a></dt>
<dd><p>The observational sampling of an astronomical light-curve</p>
<p>The zero-point, zero point system, and gain arguments can be a
collection of values (one per <code class="docutils literal notranslate"><span class="pre">obs_time</span></code> value), or a single value
to apply at all observation times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_times</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Collection</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Array of observation times for the light-curve</p></li>
<li><p><strong>bands</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Collection</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Array of bands for each observation</p></li>
<li><p><strong>zp</strong> (<em>~FloatLike</em>) – The zero-point or an array of zero-points for each observation</p></li>
<li><p><strong>zpsys</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Collection</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – The zero-point system or an array of zero-point systems</p></li>
<li><p><strong>gain</strong> (<em>~FloatLike</em>) – The simulated gain or an array of gain values</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="snat_sim.models.supernova.ObservedCadence.from_plasticc">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">from_plasticc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">light_curve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_nondetection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#ObservedCadence.from_plasticc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.ObservedCadence.from_plasticc" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the observational cadence from a PLaSTICC light-curve</p>
<p>The zero-point, zero point system, and gain arguments can be a
collection of values (one per phase value), or a single value to
apply at all obs_times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>light_curve</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code>) – Astropy table with PLaSTICC light-curve data</p></li>
<li><p><strong>zp</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[~FloatLike]) – Optionally overwrite the PLaSTICC zero-point with this value(s)</p></li>
<li><p><strong>drop_nondetection</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Drop data with PHOTFLAG == 0</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float16</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float32</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float64</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float128</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int8</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int16</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">uint8</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">uint16</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">uint32</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">uint64</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">longlong</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ulonglong</span></code>]], <a class="reference internal" href="#snat_sim.models.supernova.ObservedCadence" title="snat_sim.models.supernova.ObservedCadence"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObservedCadence</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An <code class="docutils literal notranslate"><span class="pre">ObservedCadence</span></code> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.supernova.ObservedCadence.to_sncosmo">
<code class="sig-name descname"><span class="pre">to_sncosmo</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#ObservedCadence.to_sncosmo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.ObservedCadence.to_sncosmo" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the observational cadence as an <code class="docutils literal notranslate"><span class="pre">astropy.Table</span></code></p>
<p>The returned table of observations is formatted for use with with
the <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An astropy table representing the observational cadence in <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code> format</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.supernova.ObservedCadence.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">obs_times</span></em>, <em class="sig-param"><span class="pre">bands</span></em>, <em class="sig-param"><span class="pre">skynoise=&lt;property</span> <span class="pre">object&gt;</span></em>, <em class="sig-param"><span class="pre">zp=&lt;property</span> <span class="pre">object&gt;</span></em>, <em class="sig-param"><span class="pre">zpsys=&lt;property</span> <span class="pre">object&gt;</span></em>, <em class="sig-param"><span class="pre">gain=&lt;property</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#snat_sim.models.supernova.ObservedCadence.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.supernova.SNModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.supernova.</span></code><code class="sig-name descname"><span class="pre">SNModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#SNModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.SNModel" title="Permalink to this definition">¶</a></dt>
<dd><p>An observer-frame supernova model composed of a Source and zero or more effects</p>
<dl class="py method">
<dt id="snat_sim.models.supernova.SNModel.simulate_lc">
<code class="sig-name descname"><span class="pre">simulate_lc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cadence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#SNModel.simulate_lc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.SNModel.simulate_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a SN light-curve</p>
<p>If <code class="docutils literal notranslate"><span class="pre">scatter</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then simulated flux values include an added
random component drawn from a normal distribution with a standard deviation
equal to the error of the observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cadence</strong> (<a class="reference internal" href="#snat_sim.models.supernova.ObservedCadence" title="snat_sim.models.supernova.ObservedCadence"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObservedCadence</span></code></a>) – Observational cadence to evaluate the light-curve with</p></li>
<li><p><strong>scatter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to add random noise to the flux values</p></li>
<li><p><strong>fixed_snr</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Optionally simulate the light-curve using a fixed signal to noise ratio</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The simulated light-curve as an astropy table in the <code class="docutils literal notranslate"><span class="pre">sncosmo</span></code> format</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.supernova.SNModel.fit_lc">
<code class="sig-name descname"><span class="pre">fit_lc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vparam_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minuit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minsnr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelcov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxcall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#SNModel.fit_lc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.SNModel.fit_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model parameters to photometric data via a chi-squared minimization</p>
<dl class="simple">
<dt>Fitting behavior:</dt><dd><ul class="simple">
<li><p>Parameters of the parent instance are not modified during the fit</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">modelcov</span></code> is enabled, the fit is performed multiple times until convergence.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">t0</span></code> parameter has a default fitting boundary such that the latest
phase of the model lines up with the earliest data point and the earliest
phase of the model lines up with the latest data point.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Table of photometric data.</p></li>
<li><p><strong>vparam_names</strong> – Model parameters to vary in the fit.</p></li>
<li><p><strong>bounds</strong> – Bounded range for each parameter. Keys should be parameter names, values are tuples.</p></li>
<li><p><strong>guess_amplitude</strong> – Whether or not to guess the amplitude from the data.</p></li>
<li><p><strong>guess_t0</strong> – Whether or not to guess t0. Only has an effect when fitting t0.</p></li>
<li><p><strong>guess_z</strong> – Whether or not to guess z (redshift). Only has an effect when fitting redshift.</p></li>
<li><p><strong>minsnr</strong> – When guessing amplitude and t0, only use data with signal-to-noise ratio greater than this value.</p></li>
<li><p><strong>method</strong> – Minimization method to use. Either “minuit” or “emcee”</p></li>
<li><p><strong>modelcov</strong> – Include model covariance when calculating chisq. Default is False.</p></li>
<li><p><strong>maxcall</strong> – Maximum number of chi-square iterations to evaluate when fitting.</p></li>
<li><p><strong>phase_range</strong> – If given, discard data outside this range of phases.</p></li>
<li><p><strong>wave_range</strong> – If given, discard data with bandpass effective wavelengths outside this range.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The fit result and a copy of the model set to the fitted parameters</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.supernova.SNFitResult">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.supernova.</span></code><code class="sig-name descname"><span class="pre">SNFitResult</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#SNFitResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.SNFitResult" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="snat_sim.models.supernova.SNFitResult.parameters">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">parameters</span></code><a class="headerlink" href="#snat_sim.models.supernova.SNFitResult.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The model parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.supernova.SNFitResult.vparameters">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">vparameters</span></code><a class="headerlink" href="#snat_sim.models.supernova.SNFitResult.vparameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The values of the varied parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.supernova.SNFitResult.covariance">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">covariance</span></code><a class="headerlink" href="#snat_sim.models.supernova.SNFitResult.covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>The covariance matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.supernova.SNFitResult.salt_covariance_linear">
<code class="sig-name descname"><span class="pre">salt_covariance_linear</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0Truth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#SNFitResult.salt_covariance_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.SNFitResult.salt_covariance_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>The covariance matrix of apparent magnitude and salt2 parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.supernova.SNFitResult.mu_variance_linear">
<code class="sig-name descname"><span class="pre">mu_variance_linear</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/supernova.html#SNFitResult.mu_variance_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.supernova.SNFitResult.mu_variance_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the variance in distance modulus</p>
<p>Determined using the covariance matrix of apparent magnitude and
salt2 parameters (See the <code class="docutils literal notranslate"><span class="pre">salt_covariance_linear</span></code> method).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The stretch correction factor</p></li>
<li><p><strong>beta</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The color excess correction factor</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The variance in mu</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-snat_sim.models.pwv">
<span id="modeling-pwv-effects"></span><h2>Modeling PWV Effects<a class="headerlink" href="#module-snat_sim.models.pwv" title="Permalink to this headline">¶</a></h2>
<p>Modeling functionality for Precipitable Water Vapor (PWV) and related
observational effects.</p>
<dl class="py class">
<dt id="snat_sim.models.pwv.PWVModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.pwv.</span></code><code class="sig-name descname"><span class="pre">PWVModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pwv_series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Model for interpolating the atmospheric water vapor at a given time and time</p>
<dl class="py method">
<dt id="snat_sim.models.pwv.PWVModel.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pwv_series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a model for time variable PWV by drawing from a given PWV time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pwv_series</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code>) – PWV values with a datetime index</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.PWVModel.from_suominet_receiver">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">from_suominet_receiver</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">receiver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supp_years</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVModel.from_suominet_receiver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVModel.from_suominet_receiver" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <code class="docutils literal notranslate"><span class="pre">PWVModel</span></code> instance using data from a SuomiNet receiver</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>receiver</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">GPSReceiver</span></code>) – GPS receiver to access data from</p></li>
<li><p><strong>year</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Year to use data from when building the model</p></li>
<li><p><strong>supp_years</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Collection</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Years to supplement data with when missing from <code class="docutils literal notranslate"><span class="pre">year</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#snat_sim.models.pwv.PWVModel" title="snat_sim.models.pwv.PWVModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PWVModel</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An interpolation function that accepts <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">format</span></code> arguments</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.PWVModel.calc_airmass">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">calc_airmass</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">30.244573</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">70.7499537</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mjd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_below_horizon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVModel.calc_airmass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVModel.calc_airmass" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the airmass through which a target is observed</p>
<p>Default latitude, longitude, and altitude are set to the Rubin
Observatory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – Time at which the target is observed</p></li>
<li><p><strong>ra</strong> – Right Ascension of the target (Deg)</p></li>
<li><p><strong>dec</strong> – Declination of the target (Deg)</p></li>
<li><p><strong>lat</strong> – Latitude of the observer (Deg)</p></li>
<li><p><strong>lon</strong> – Longitude of the observer (Deg)</p></li>
<li><p><strong>alt</strong> – Altitude of the observer (m)</p></li>
<li><p><strong>time_format</strong> – Astropy supported format of the time value (Default: ‘mjd’)</p></li>
<li><p><strong>raise_below_horizon</strong> – If true, raise a ValueError for an airmasses less than 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Airmass in units of Sec(z)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.PWVModel.pwv_zenith">
<code class="sig-name descname"><span class="pre">pwv_zenith</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mjd'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVModel.pwv_zenith"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVModel.pwv_zenith" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the PWV at zenith as a function of time</p>
<p>The <code class="docutils literal notranslate"><span class="pre">time_format</span></code> argument can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> when passing datetime
objects for <code class="docutils literal notranslate"><span class="pre">time</span></code> instead of numerical values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – The time to interpolate PWV for</p></li>
<li><p><strong>time_format</strong> – Astropy supported format of the time value (Default: ‘mjd’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The PWV at zenith for the given time(s)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.PWVModel.pwv_los">
<code class="sig-name descname"><span class="pre">pwv_los</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">30.244573</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">70.7499537</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mjd'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVModel.pwv_los"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVModel.pwv_los" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the PWV along the line of sight as a function of time</p>
<p>The <code class="docutils literal notranslate"><span class="pre">time_format</span></code> argument can be set to <code class="docutils literal notranslate"><span class="pre">None</span></code> when passing datetime
objects instead of numerical values for <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – Time at which the target is observed</p></li>
<li><p><strong>ra</strong> – Right Ascension of the target (Deg)</p></li>
<li><p><strong>dec</strong> – Declination of the target (Deg)</p></li>
<li><p><strong>lat</strong> – Latitude of the observer (Deg)</p></li>
<li><p><strong>lon</strong> – Longitude of the observer (Deg)</p></li>
<li><p><strong>alt</strong> – Altitude of the observer (m)</p></li>
<li><p><strong>time_format</strong> – Astropy supported format of the time value (Default: ‘mjd’)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The PWV concentration along the line of sight to the target</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.PWVModel.seasonal_averages">
<code class="sig-name descname"><span class="pre">seasonal_averages</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVModel.seasonal_averages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVModel.seasonal_averages" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the average PWV in each season</p>
<p>Assumes seasons based on equinox and solstice dates in the year 2020.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary with the average PWV in each season (in mm)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.pwv.PWVTransmissionModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.pwv.</span></code><code class="sig-name descname"><span class="pre">PWVTransmissionModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVTransmissionModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVTransmissionModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Models atmospheric transmission due to PWV at a fixed resolution</p>
<dl class="py method">
<dt id="snat_sim.models.pwv.PWVTransmissionModel.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVTransmissionModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVTransmissionModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a PWV transmission model at the given resolution</p>
<p>Transmission values are determined using the <code class="docutils literal notranslate"><span class="pre">v1_transmission</span></code> model
from the <code class="docutils literal notranslate"><span class="pre">pwv_kpno</span></code> package.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>resolution</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Resolution to bin the atmospheric model to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.PWVTransmissionModel.calc_transmission">
<code class="sig-name descname"><span class="pre">calc_transmission</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pwv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#PWVTransmissionModel.calc_transmission"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.PWVTransmissionModel.calc_transmission" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate transmission model at given wavelengths</p>
<p>Returns a <code class="docutils literal notranslate"><span class="pre">Series</span></code> object if <code class="docutils literal notranslate"><span class="pre">pwv</span></code> is a scalar, and a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
object if <code class="docutils literal notranslate"><span class="pre">pwv</span></code> is an array. Wavelengths are expected in angstroms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pwv</strong> – Line of sight PWV to interpolate for</p></li>
<li><p><strong>wave</strong> – Wavelengths to evaluate transmission (Defaults to <code class="docutils literal notranslate"><span class="pre">samp_wave</span></code> attribute)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The interpolated transmission at the given wavelengths / resolution</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.pwv.VariablePropagationEffect">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.pwv.</span></code><code class="sig-name descname"><span class="pre">VariablePropagationEffect</span></code><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#VariablePropagationEffect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.VariablePropagationEffect" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for propagation effects that vary with time</p>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">sncosmo.PropagationEffect</span></code> class, but the <code class="docutils literal notranslate"><span class="pre">propagate</span></code>
method accepts a <code class="docutils literal notranslate"><span class="pre">time</span></code> argument.</p>
<dl class="py method">
<dt id="snat_sim.models.pwv.VariablePropagationEffect.propagate">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">propagate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#VariablePropagationEffect.propagate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.VariablePropagationEffect.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate the flux through the atmosphere</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – An array of wavelength values</p></li>
<li><p><strong>flux</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – An array of flux values</p></li>
<li><p><strong>time</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of time values</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array of flux values after suffering propagation effects</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.pwv.StaticPWVTrans">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.pwv.</span></code><code class="sig-name descname"><span class="pre">StaticPWVTrans</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#StaticPWVTrans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.StaticPWVTrans" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagation effect for the atmospheric absorption of light due to time static PWV</p>
<dl class="py method">
<dt id="snat_sim.models.pwv.StaticPWVTrans.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#StaticPWVTrans.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.StaticPWVTrans.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Time independent atmospheric transmission due to PWV</p>
<p>Setting the <code class="docutils literal notranslate"><span class="pre">transmission_res</span></code> argument to <code class="docutils literal notranslate"><span class="pre">None</span></code> results in the
highest available transmission model available.</p>
<dl class="simple">
<dt>Effect Parameters:</dt><dd><p>pwv: Atmospheric concentration of PWV along line of sight in mm</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transmission_res</strong> (<em>float</em>) – Reduce the underlying transmission model by binning to the given resolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.StaticPWVTrans.transmission_res">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">transmission_res</span></code><a class="headerlink" href="#snat_sim.models.pwv.StaticPWVTrans.transmission_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolution used when binning the underlying atmospheric transmission model</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.StaticPWVTrans.propagate">
<code class="sig-name descname"><span class="pre">propagate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#StaticPWVTrans.propagate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.StaticPWVTrans.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate the flux through the atmosphere</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – A 1D array of wavelength values</p></li>
<li><p><strong>flux</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – An array of flux values</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array of flux values after suffering from PWV absorption</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.pwv.AbstractVariablePWVEffect">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.pwv.</span></code><code class="sig-name descname"><span class="pre">AbstractVariablePWVEffect</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#AbstractVariablePWVEffect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.AbstractVariablePWVEffect" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="snat_sim.models.pwv.AbstractVariablePWVEffect.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#AbstractVariablePWVEffect.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.AbstractVariablePWVEffect.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Time independent atmospheric transmission due to PWV</p>
<p>Setting the <code class="docutils literal notranslate"><span class="pre">transmission_res</span></code> argument to <code class="docutils literal notranslate"><span class="pre">None</span></code> results in the
highest available transmission model available.</p>
<dl class="simple">
<dt>Effect Parameters:</dt><dd><p>pwv: Atmospheric concentration of PWV along line of sight in mm</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transmission_res</strong> (<em>float</em>) – Reduce the underlying transmission model by binning to the given resolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.AbstractVariablePWVEffect.assumed_pwv">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">assumed_pwv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#AbstractVariablePWVEffect.assumed_pwv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.AbstractVariablePWVEffect.assumed_pwv" title="Permalink to this definition">¶</a></dt>
<dd><p>The PWV concentration used by the propagation effect at a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong><strong>)</strong> – Time to get the PWV concentration for</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>~FloatLike</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array of PWV values in units of mm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.AbstractVariablePWVEffect.propagate">
<code class="sig-name descname"><span class="pre">propagate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#AbstractVariablePWVEffect.propagate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.AbstractVariablePWVEffect.propagate" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate the flux through the atmosphere</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – An array of wavelength values</p></li>
<li><p><strong>flux</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – An array of flux values</p></li>
<li><p><strong>time</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Array of time values to determine PWV for</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array of flux values after suffering from PWV absorption</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.pwv.VariablePWVTrans">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.pwv.</span></code><code class="sig-name descname"><span class="pre">VariablePWVTrans</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pwv_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mjd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#VariablePWVTrans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.VariablePWVTrans" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagation effect for the atmospheric absorption of light due to time variable PWV</p>
<dl class="py method">
<dt id="snat_sim.models.pwv.VariablePWVTrans.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pwv_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mjd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#VariablePWVTrans.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.VariablePWVTrans.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Time variable atmospheric transmission due to PWV</p>
<p>Setting the <code class="docutils literal notranslate"><span class="pre">transmission_res</span></code> argument to <code class="docutils literal notranslate"><span class="pre">None</span></code> results in the
highest available transmission model available.</p>
<dl class="simple">
<dt>Effect Parameters:</dt><dd><p>ra: Target Right Ascension in degrees
dec: Target Declination in degrees
lat: Observer latitude in degrees (defaults to location of VRO)
lon: Observer longitude in degrees (defaults to location of VRO)
alt: Observer altitude in meters  (defaults to height of VRO)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pwv_model</strong> (<a class="reference internal" href="#snat_sim.models.pwv.PWVModel" title="snat_sim.models.pwv.PWVModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">PWVModel</span></code></a>) – Returns PWV at zenith for a given time value and time format</p></li>
<li><p><strong>time_format</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Astropy recognized time format used by the <code class="docutils literal notranslate"><span class="pre">pwv_interpolator</span></code></p></li>
<li><p><strong>transmission_res</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Reduce the underlying transmission model by binning to the given resolution</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.VariablePWVTrans.assumed_pwv">
<code class="sig-name descname"><span class="pre">assumed_pwv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#VariablePWVTrans.assumed_pwv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.VariablePWVTrans.assumed_pwv" title="Permalink to this definition">¶</a></dt>
<dd><p>The PWV concentration used by the propagation effect at a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong><strong>)</strong> – Time to get the PWV concentration for</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>~FloatLike</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array of PWV values in units of mm</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="snat_sim.models.pwv.SeasonalPWVTrans">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">snat_sim.models.pwv.</span></code><code class="sig-name descname"><span class="pre">SeasonalPWVTrans</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mjd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#SeasonalPWVTrans"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.SeasonalPWVTrans" title="Permalink to this definition">¶</a></dt>
<dd><p>Atmospheric propagation effect for a fixed PWV concentration per-season</p>
<dl class="py method">
<dt id="snat_sim.models.pwv.SeasonalPWVTrans.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mjd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transmission_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#SeasonalPWVTrans.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.SeasonalPWVTrans.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Time variable atmospheric transmission due to PWV that changes per season</p>
<dl class="simple">
<dt>Effect Parameters:</dt><dd><p>ra: Target Right Ascension in degrees
dec: Target Declination in degrees
lat: Observer latitude in degrees (defaults to location of VRO)
lon: Observer longitude in degrees (defaults to location of VRO)
alt: Observer altitude in meters  (defaults to height of VRO)
winter:</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_format</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Astropy recognized time format used by the <code class="docutils literal notranslate"><span class="pre">pwv_interpolator</span></code></p></li>
<li><p><strong>transmission_res</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Reduce the underlying transmission model by binning to the given resolution</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.SeasonalPWVTrans.assumed_pwv">
<code class="sig-name descname"><span class="pre">assumed_pwv</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#SeasonalPWVTrans.assumed_pwv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.SeasonalPWVTrans.assumed_pwv" title="Permalink to this definition">¶</a></dt>
<dd><p>The PWV concentration used by the propagation effect at a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<em>~FloatLike</em>) – Time to get the PWV concentration for</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>~FloatLike</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An array of PWV values in units of mm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="snat_sim.models.pwv.SeasonalPWVTrans.from_pwv_model">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">from_pwv_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pwv_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/snat_sim/models/pwv.html#SeasonalPWVTrans.from_pwv_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#snat_sim.models.pwv.SeasonalPWVTrans.from_pwv_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new instance using the averaged per-season PWV from a PWV model</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plasticc.html" title="snat_sim.plasticc"
             >next</a> |</li>
        <li class="right" >
          <a href="constants.html" title="snat_sim.constants"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SNAT-SIM</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">snat_sim.models</a></li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2020, Dark Energy Science Collaboration. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>