
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Effective PWV on a Black Body &#8212; Supernova Atmospheric Simulation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_style.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PWV effects on SN Magnitude" href="sne_delta_mag.html" />
    <link rel="prev" title="LSST Filters" href="lsst_filters.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sne_delta_mag.html" title="PWV effects on SN Magnitude"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lsst_filters.html" title="LSST Filters"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SNAT-SIM</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Effective PWV on a Black Body</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../index.html" class="text-logo">SNAT-SIM</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/install.html">Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/data_provenance.html">Data Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/command_line.html">Command Line Interface</a></li>
</ul>
<p class="caption"><span class="caption-text">Notebooks / Science Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="notebook_summaries.html">Notebook Summaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="lsst_filters.html">LSST Filters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Effective PWV on a Black Body</a></li>
<li class="toctree-l1"><a class="reference internal" href="sne_delta_mag.html">PWV effects on SN Magnitude</a></li>
<li class="toctree-l1"><a class="reference internal" href="pwv_modeling.html">PWV Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulating_lc_for_cadence.html">Simulating Light-Curves with a Cadence</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/constants.html">snat_sim.constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/filters.html">snat_sim.filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/models.html">snat_sim.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/fitting_pipeline.html">snat_sim.fitting_pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/plasticc.html">snat_sim.plasticc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/reference_stars.html">snat_sim.reference_stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/sn_magnitudes.html">snat_sim.sn_magnitudes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/plotting.html">snat_sim.plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utils_caching.html">snat_sim.utils.caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utils_time_series.html">snat_sim.utils.time_series</a></li>
</ul>

    
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">

          <div class="document clearer body">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Effective-PWV-on-a-Black-Body">
<h1>Effective PWV on a Black Body<a class="headerlink" href="#Effective-PWV-on-a-Black-Body" title="Permalink to this headline">¶</a></h1>
<p>The effective precipitable water vapor is defined as a rescaling of the precipitable water vapor (PWV) along the the line of sight such that changes in the brightness of an object become (roughly) linear. This notebook demonstrates the definition of effective PWV by plotting the PWV induced change in the magnitude of a Black Body.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sncosmo</span>
<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pwv_kpno.defaults</span> <span class="kn">import</span> <span class="n">v1_transmission</span>
<span class="kn">from</span> <span class="nn">snat_sim.filters</span> <span class="kn">import</span> <span class="n">register_lsst_filters</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="s1">&#39;figs&#39;</span>
<span class="n">fig_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">register_lsst_filters</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">black_body_sed</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="n">pwv</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulate a black body spectrum with PWV effects</span>

<span class="sd">    Args:</span>
<span class="sd">        temp        (float): Temperature of the black body in Kelvin</span>
<span class="sd">        wavelengths (array): Wavelengths to simulate the SED at</span>
<span class="sd">        pwv         (float): PWV concentration to apply</span>
<span class="sd">        res         (float): Resolution to sample the atmosphere with</span>

<span class="sd">    Returns:</span>
<span class="sd">        An array of flux values</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bb</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BlackBody</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temp</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
    <span class="n">flux_without_atm</span> <span class="o">=</span> <span class="n">bb</span><span class="p">(</span><span class="n">wavelengths</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
    <span class="n">transmission</span> <span class="o">=</span> <span class="n">v1_transmission</span><span class="p">(</span><span class="n">pwv</span><span class="p">,</span> <span class="n">wavelengths</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flux_without_atm</span> <span class="o">*</span> <span class="n">transmission</span>


<span class="k">def</span> <span class="nf">calc_delta_bb_mag</span><span class="p">(</span><span class="n">pwv_vals</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="n">bb_temp</span><span class="o">=</span><span class="mi">8000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the PWV induced change in magnitude for a black body</span>

<span class="sd">    Args:</span>
<span class="sd">        pwv_vals (array): The pwv values to plot saturation for</span>
<span class="sd">        band  (Bandpass): SNCosmo bandpass</span>
<span class="sd">        bb_temp  (float): Temperature of the black body to use</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of delta magnitudes in the given band</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">band</span><span class="o">.</span><span class="n">minwave</span><span class="p">(),</span> <span class="n">band</span><span class="o">.</span><span class="n">maxwave</span><span class="p">(),</span> <span class="o">.</span><span class="mi">05</span><span class="p">)</span>
    <span class="n">base_sed</span> <span class="o">=</span> <span class="n">black_body_sed</span><span class="p">(</span><span class="n">bb_temp</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">pwv</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">base_mag</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">base_sed</span> <span class="o">*</span> <span class="n">wave</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wave</span><span class="p">))</span>

    <span class="n">delta_mag</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pwv</span> <span class="ow">in</span> <span class="n">pwv_vals</span><span class="p">:</span>
        <span class="n">sed_with_pwv</span> <span class="o">=</span> <span class="n">black_body_sed</span><span class="p">(</span><span class="n">bb_temp</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">pwv</span><span class="p">)</span>
        <span class="n">pwv_mag</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">sed_with_pwv</span> <span class="o">*</span> <span class="n">wave</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wave</span><span class="p">))</span>
        <span class="n">delta_mag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pwv_mag</span> <span class="o">-</span> <span class="n">base_mag</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">delta_mag</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plot_delta_bb_mag</span><span class="p">(</span><span class="n">pwv_los</span><span class="p">,</span> <span class="n">pwv_los_labels</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">norm_pwv</span><span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fid_pwv</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot the PWV induced change in magnitude for a black body</span>

<span class="sd">    Plot relative to LOS and effective PWV</span>

<span class="sd">    Args:</span>
<span class="sd">        pwv_los        (array): PWV values along line of sight</span>
<span class="sd">        pwv_los_labels (array): Axis labels for line of sight PWV</span>
<span class="sd">        exp            (float): Exponent for calculating PWV_eff from PWV_los</span>
<span class="sd">        norm_pwv       (float): PWV value used to determine ``coef``</span>
<span class="sd">        fid_pwv        (float): Fiducial PWV used in the paper</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">coef</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">norm_pwv</span> <span class="o">**</span> <span class="n">exp</span><span class="p">)</span>

    <span class="c1"># Convert PWV line-of-sight into PWV effective</span>
    <span class="n">pwv_eff</span> <span class="o">=</span> <span class="n">coef</span> <span class="o">*</span> <span class="p">(</span><span class="n">pwv_los</span> <span class="o">**</span> <span class="n">exp</span><span class="p">)</span>
    <span class="n">pwv_eff_labels</span> <span class="o">=</span> <span class="n">coef</span> <span class="o">*</span> <span class="p">(</span><span class="n">pwv_los_labels</span> <span class="o">**</span> <span class="n">exp</span><span class="p">)</span>

    <span class="c1"># Create axes for plotting vs los and effective pwv</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">left_ax</span><span class="p">,</span> <span class="n">right_ax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">left_twin_y</span> <span class="o">=</span> <span class="n">left_ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">right_twin_y</span> <span class="o">=</span> <span class="n">right_ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>

    <span class="c1"># Manually set axis limits to avoid wrestling with the auto scaling later on</span>
    <span class="n">los_xlim</span> <span class="o">=</span> <span class="n">pwv_los_labels</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">pwv_los_labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="n">left_twin_y</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">los_xlim</span><span class="p">)</span>
    <span class="n">left_twin_y</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">pwv_los_labels</span><span class="p">)</span>
    <span class="n">left_twin_y</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">pwv_los_labels</span><span class="p">)</span>

    <span class="n">eff_xlim</span> <span class="o">=</span> <span class="n">pwv_eff_labels</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">pwv_eff_labels</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">right_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">eff_xlim</span><span class="p">)</span>

    <span class="n">right_twin_y</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">eff_xlim</span><span class="p">)</span>
    <span class="n">right_twin_y</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">pwv_eff_labels</span><span class="p">)</span>
    <span class="n">right_twin_y</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">pwv_los_labels</span><span class="p">)</span>

    <span class="c1"># Plot delta mag for each band</span>
    <span class="k">for</span> <span class="n">band_abbrev</span> <span class="ow">in</span> <span class="s1">&#39;rizy&#39;</span><span class="p">:</span>
        <span class="n">band_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;lsst_hardware_</span><span class="si">{</span><span class="n">band_abbrev</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">band</span> <span class="o">=</span> <span class="n">sncosmo</span><span class="o">.</span><span class="n">get_bandpass</span><span class="p">(</span><span class="n">band_name</span><span class="p">)</span>
        <span class="n">delta_mag</span> <span class="o">=</span> <span class="n">calc_delta_bb_mag</span><span class="p">(</span><span class="n">pwv_los</span><span class="p">,</span> <span class="n">band</span><span class="p">)</span>

        <span class="n">left_twin_y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pwv_los</span><span class="p">,</span> <span class="n">delta_mag</span><span class="p">)</span>
        <span class="n">right_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pwv_eff</span><span class="p">,</span> <span class="n">delta_mag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;LSST </span><span class="si">{</span><span class="n">band_abbrev</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Plot reference lines for pwv values</span>
    <span class="n">left_twin_y</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">norm_pwv</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">85</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Norm pwv&#39;</span><span class="p">)</span>
    <span class="n">left_twin_y</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">fid_pwv</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fiducial pwv&#39;</span><span class="p">)</span>
    <span class="n">right_twin_y</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">coef</span> <span class="o">*</span> <span class="p">(</span><span class="n">norm_pwv</span> <span class="o">**</span> <span class="n">exp</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">85</span><span class="p">)</span>
    <span class="n">right_twin_y</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">coef</span> <span class="o">*</span> <span class="p">(</span><span class="n">fid_pwv</span> <span class="o">**</span> <span class="n">exp</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">7</span><span class="p">)</span>

    <span class="n">eff_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">pwv_eff_labels</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">los_ticks</span> <span class="o">=</span> <span class="p">(</span><span class="n">eff_ticks</span> <span class="o">/</span> <span class="n">coef</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">exp</span><span class="p">)</span>
    <span class="n">left_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">los_ticks</span><span class="p">)</span>
    <span class="n">left_ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">eff_ticks</span><span class="p">)</span>
    <span class="n">left_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">los_xlim</span><span class="p">)</span>

    <span class="c1"># A final bit of formatting</span>
    <span class="n">left_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Delta$ mag&#39;</span><span class="p">)</span>
    <span class="n">left_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;PWV$_</span><span class="si">{eff}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">left_twin_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;PWV$_</span><span class="si">{los}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">right_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;PWV$_</span><span class="si">{eff}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">right_twin_y</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;PWV$_</span><span class="si">{los}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">left_twin_y</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">right_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">left_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Sample PWV values more frequently at lower values for a smoother curve</span>
<span class="n">pwv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">01</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">12.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">pwv_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">plot_delta_bb_mag</span><span class="p">(</span><span class="n">pwv</span><span class="p">,</span> <span class="n">pwv_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;delta_bb_mag.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_pwv_eff_on_black_body_5_0.png" src="../_images/notebooks_pwv_eff_on_black_body_5_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sne_delta_mag.html" title="PWV effects on SN Magnitude"
             >next</a> |</li>
        <li class="right" >
          <a href="lsst_filters.html" title="LSST Filters"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SNAT-SIM</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Effective PWV on a Black Body</a></li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2020, Dark Energy Science Collaboration. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>